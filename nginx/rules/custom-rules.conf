# ==========================================================
# Custom WAF Rules for Demo
# ==========================================================

# 1) SQLi detection (very simple pattern)
SecRule ARGS "(?i:(union.*select|select.+from|or.+1=1|\'\s*or\s*\'1\'=\'1))" \
 "id:1000001,phase:2,deny,log,status:403,msg:'Custom rule: SQLi pattern detected'"

# 2) Block scanner User-Agent
SecRule REQUEST_HEADERS:User-Agent "@rx (?i)(sqlmap|nikto|wpscan|curl)" \
 "id:1000002,phase:1,deny,log,status:403,msg:'Custom rule: Suspicious User-Agent blocked'"

# 3) Block very long URIs (DoS/fuzzing)
SecRule REQUEST_URI "@gt 2048" \
 "id:1000003,phase:1,deny,log,status:414,msg:'Custom rule: URI too long'"

# 4) Add custom tags for logging
SecRule REQUEST_METHOD ".*" \
 "id:1000004,phase:1,pass,nolog,tag:'project:nginx-waf-proxy',tag:'env:demo'"
